# Track-Dir-Changes
A script to track additions, deletions, and file changes inside a directory

A friend of mine had a problem. In his work they used some cloud storage (think GoogleDrive or Dropbox) to collaborate. All employees had a directory in their computer where changes were synced. The problem was that from time to time someone would make large changes to this shared directory, and syncing was costly since many employees worked remotely. Some of these changes were a mistake, so my friend wanted to monitor the usage of this shared directory. He wanted a simple program that would check the synced folder periodically (once or twice a day) and let him know if there were any significant additions/deletions/changes. He could not find a tool doing what he wanted, so he asked me if I could make one. This is this effort.

You need Python 2.7 to run this tool. It is made with Mac OS X in mind, but it could be adapted to work on other platforms as well. The two things that need adapting to work on other platforms are: the alert method, and the way to run it as a daemon.

This tool is better run as a daemon in the background (more on this later), but it can also be executed from a terminal just once using the `--once` switch. 
```
> ./trackDirFileChanges.py --once -d dir_you_want_tracked
```

The tool creates two files in the directory you specified as log_dir (default: /var/log/)

- The first one is a .json file recording the last seen file and directory structure snapshop: `<log_dir>/Track<dir path>.json`
If this file is not found, or is corrupted, then the program assumes that we just started tracking this directory, reports some aggregate information in the change log and creates the .json file 
- The second one is a log of the changes we find over time: `<log_dir>/Track<dir path>changes.log`

When the program runs and there is a previous state to compare the directory structure to, it finds all changes made (additions, deletions, changes in file size) and records them in the change log. If one of a series of user-defined thresholds is crossed then the program also alert the user by creating an OSC notification (a window that you see on the top right corner of your screen that disappears after a few seconds). Here are the four user defined threasholds and their correspending switches
- Absolute size in MB. Use switch `-s` or `--sizeabs` followed by a number (default=30)
- Relative size change compared to current total size. Use switch `-r` or `--sizerel` followed by a fraction (default=0.05)
- Absolute number of files. Use switch `-n` or `--numabs` followed by a number (default=50)
- Relative file number change compared to total file number. Use switch `-q` or `--numrel` followed by a fraction (default=0.05)

Note that we only rely on file size to determine that a file has changed or not, not on a hash generated by the file. This is acceptabe because the main application of this script is to track size changes.
